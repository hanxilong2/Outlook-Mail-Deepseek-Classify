
# Outlook邮件自动分类工具 - 使用文档

## 一、程序功能说明

本工具是一款基于Python的Outlook邮件自动分类助手，通过调用Deepseek API对邮件内容进行分析，将邮件自动归类到指定文件夹中。核心功能包括：

1. **灵活的邮件筛选**  
   支持按时间范围（今天/本工作日/本周/本月）或数量（最新N封）筛选需要处理的邮件。

2. **智能内容分类**  
   利用AI模型对邮件内容进行分析，自动归类到预定义的分类文件夹（如"垃圾邮件"、"学校"、"游戏"等）。

3. **自动化文件夹管理**  
   自动创建分类所需的文件夹，无需手动提前设置。

4. **并行处理加速**  
   采用多线程并行分析邮件内容，提升大批量邮件的处理效率。

5. **详细日志记录**  
   全程记录操作过程，便于追踪处理结果和排查问题。


## 二、环境准备

### 1. 依赖安装

需安装以下Python库：

```bash
pip install openai pywin32 python-dotenv
```

- `openai`：用于调用Deepseek API
- `pywin32`：用于操作Windows系统下的Outlook客户端


### 2. 前置条件

- **操作系统**：仅支持Windows（需依赖Outlook客户端）
- **Outlook配置**：已安装Microsoft Outlook并配置好邮箱账户（能正常接收邮件）
- **API密钥**：需拥有Deepseek API的有效密钥（可从Deepseek官方平台获取）


## 三、使用步骤

### 1. 配置API密钥

打开程序，找到以下代码行，替换为你的Deepseek API密钥：

```python
DEEPSEEK_API_KEY = "sk-你的API密钥"  # 替换为实际API密钥
```


### 2. 自定义分类标签（可选）

如需修改分类标签，修改`CATEGORIES`列表即可：

```python
CATEGORIES = ["垃圾邮件", "学校", "游戏", "公司", "学习"]  # 可根据需求增删，建议为垃圾邮件、学习、工作、娱乐、其他
```

> 注意："未分类"为系统默认标签，用于标记无法识别的邮件，可能在分析时遇到


### 3. 运行程序

直接执行Python脚本，程序会引导你完成以下操作：

#### 步骤1：查看收件箱总邮件数

程序启动后会显示当前Outlook收件箱的总邮件数量：

```
当前收件箱总邮件数: 128 封
```

#### 步骤2：选择邮件筛选方式

根据需求选择筛选方式（输入1-5的数字）：

```
请选择邮件筛选方式：
1. 今天（处理今天所有邮件）
2. 本工作日（处理本周一至当前所有邮件）
3. 本周（处理本周所有邮件）
4. 本月（处理本月所有邮件）
5. 指定数目（处理最新的N封邮件，不限制时间）
请输入选项(1-5)：
```

#### 步骤3：输入处理数量（仅第5项需要）

若选择第5项，需输入需要处理的邮件数量：

```
请输入需要处理的邮件数量：20
```

#### 步骤4：自动处理过程

程序会自动执行以下操作：

- 筛选符合条件的邮件
- 分批次并行分析邮件内容
- 自动创建分类文件夹（如不存在）
- 将邮件移动到对应分类文件夹
- 实时显示处理进度（包括每封邮件的主题和分类结果）


### 4. 查看结果

- **邮件分类**：打开Outlook，收件箱下会新增分类文件夹，邮件已按分类自动移动
- **日志记录**：程序生成`email_analysis.log`文件，记录所有操作细节（包括错误信息）


## 四、参数说明（可自定义调整）

| 参数名              | 作用                    | 默认值           |
| ------------------- | ----------------------- | ---------------- |
| `MAX_WORKERS`       | 并行分析的最大线程数    | 5（或CPU核心数） |
| `API_REQUEST_DELAY` | API请求间隔（避免限流） | 1.0秒            |
| `BATCH_SIZE`        | 每批处理的邮件数量      | 10封             |


## 五、常见问题解决

1. **Outlook连接失败**  
   - 确保Outlook已安装并正常运行
   - 首次运行需授予Python访问Outlook的权限（在弹出的对话框中选择"允许"）
   - 检查是否有多个Outlook账户，程序默认使用第一个配置的账户

2. **API调用失败**  
   - 检查API密钥是否有效（是否过期或输入错误）
   - 网络环境是否可访问Deepseek API服务器
   - 若提示"限流"，可增大`API_REQUEST_DELAY`的值

3. **邮件移动失败**  
   - 确保Outlook未处于"离线"状态
   - 关闭正在编辑的邮件窗口（避免文件锁定）
   - 检查目标文件夹是否被手动删除


## 六、注意事项

1. 处理大量邮件时，建议分批次进行（如每次处理50封以内）
2. 程序运行期间请勿手动操作Outlook，避免干扰邮件移动
3. "未分类"邮件不会被移动，将保留在收件箱中
4. 日志文件`email_analysis.log`可用于追溯处理记录，建议定期备份


通过以上步骤，即可实现Outlook邮件的自动化分类管理，提高邮件处理效率。
